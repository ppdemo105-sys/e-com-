<!-- Loading State -->
@if(isLoading()) {
<app-loader />
}

<!-- Product -->
@else if(!isLoading() && !errorState()) {
<!-- Temporary Header BG Fix -->
<div class="top-0 left-0 w-full bg-text h-[67px] -z-10"></div>

<app-container>
  <!-- Product -->
  <article
    class="grid grid-cols-1 sm:grid-cols-2 mt-16 gap-5 sm:gap-10 md:gap-14"
  >
    <div class="relative overflow-hidden rounded-lg">
      <img
        [src]="product()?.image_path"
        [alt]="`${product.name}'s Picture`"
        class="size-full object-cover rounded-lg transition-all duration-200 hover:brightness-90 hover:scale-105 ease-in-out"
      />

      <span
        class="absolute top-2 left-2 bg-accent text-surface px-4 py-1 rounded-full text-lg transition-colors duration-200 hover:bg-accent/90"
        >{{product()?.category}}</span
      >
    </div>

    <div class="flex flex-col gap-3 sm:gap-5 md:gap-8">
      <!-- Name & Description -->
      <h2 class="text-3xl sm:text-4xl xl:text-5xl font-medium">
        {{product()?.name}}
      </h2>
      <p class="text-muted max-w-sm text-xl">{{product()?.description}}</p>

      <!-- Price & Discount -->
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-2">
          <span class="text-3xl md:text-4xl"
            >{{product()?.discount_price | currency:'EUR'}}</span
          >
          <del class="text-red-600 text-xl md:text-2xl"
            >{{product()?.price | currency:'EUR'}}</del
          >
        </div>

        <!--====== Wishlist ======-->
        <button
          class="grid top-2 right-2 place-items-center p-2 cursor-pointer border border-border transition duration-100 hover:bg-border/20"
          aria-label="Add Product To Wishlist"
          (click)="toggleWishlist(product()!)"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="red"
            [attr.fill]="isFavorite(product()!.id) ? 'red' : 'none'"
            class="size-6"
            [ngClass]="isFavorite(product()!.id) ? 'rotate-360 transition-transform duration-500 ease-in-out' : ''"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z"
            />
          </svg>
        </button>
      </div>

      <!-- Dimensions -->
      <ul
        class="flex flex-wrap gap-4 pt-3 md:pt-8 border-t-2 border-zinc-400 text-gray-700"
      >
        <li class="flex items-center gap-2">
          <strong class="md:text-lg">Depth:</strong>
          <span class="text-lg border border-border p-2"
            >{{ product()?.dimensions?.depth }} cm</span
          >
        </li>

        <li class="flex items-center gap-2">
          <strong class="md:text-lg">Width:</strong>
          <span class="text-lg border border-border p-2"
            >{{ product()?.dimensions?.width }} cm</span
          >
        </li>

        <li class="flex items-center gap-2">
          <strong class="md:text-lg">Heigth:</strong>
          <span class="text-lg border border-border p-2"
            >{{ product()?.dimensions?.height }} cm</span
          >
        </li>
      </ul>
    </div>
  </article>

  <!-- Related Products -->
  <h3
    class="font-secondary text-4xl xl:text-5xl text-center mt-14 sm:mt-16 md:mt-24 lg:mt-28"
  >
    You may also like
  </h3>

  <!-- Loading State -->
  @if (isLoading()) {
  <ul
    class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 items-center gap-8 lg:gap-12 xl:gap-20 mt-14 md:mt-20"
  >
    @for (skeletonCard of skeletonCards; track $index) {
    <li>
      <app-skeleton-card />
    </li>
    }
  </ul>
  }

  <!-- Error State -->
  @else if (errorState()) {
  <h3 class="text-center text-red-500">{{errorState()}}</h3>
  }

  <!-- Featured Products -->
  @else if (relatedProducts().length > 0) {
  <ul class="products-list">
    @for (product of relatedProducts(); track product.id) {
    <li>
      <app-product-card [product]="product" />
    </li>
    }
  </ul>
  }

  <!-- No Products -->
  @else {
  <p class="text-center py-10">No featured products found.</p>
  }
</app-container>
}
